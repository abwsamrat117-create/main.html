<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูููุน ุงูุจุซ ูุน Proxy</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #0a192f;
            color: white;
            text-align: center;
            padding: 20px;
            margin: 0;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        video {
            width: 100%;
            max-height: 70vh;
            background: black;
            border-radius: 10px;
        }
        
        .warning {
            background: #ff6b6b;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: right;
        }
        
        .solution {
            background: #1e3a8a;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: right;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>๐ก ูููุน ุงูุจุซ ูุน ุญู ูุดููุฉ CORS</h1>
        
        <div class="warning">
            <h3>โ๏ธ ุงููุดููุฉ: CORS Policy</h3>
            <p>ุงูุฎุงุฏู ูููุน ุงููุตูู ูู ูุทุงูุงุช ูุฎุชููุฉ. ุงูุญููู:</p>
        </div>
        
        <!-- ุงูุฎูุงุฑ 1: Proxy ูุจุงุดุฑ -->
        <div class="solution">
            <h3>ุงูุญู 1: ุงุณุชุฎุฏุงู CORS Proxy</h3>
            <video id="proxyVideo" controls></video>
            <p>ุฌุงุฑู ุงุณุชุฎุฏุงู proxy ููุชุบูุจ ุนูู CORS...</p>
        </div>
        
        <!-- ุงูุฎูุงุฑ 2: Iframe ุจูุนููุงุช ูุฎุชููุฉ -->
        <div class="solution">
            <h3>ุงูุญู 2: Iframe ูุน Referrer Policy</h3>
            <iframe 
                id="streamFrame"
                style="width:100%; height:500px; border:none; border-radius:10px;"
                allow="autoplay; fullscreen"
                referrerpolicy="no-referrer-when-downgrade"
            ></iframe>
        </div>
        
        <!-- ุงูุฎูุงุฑ 3: ุชุญููู ุงูุจูุงูุงุช ุซู ุชุดุบูููุง -->
        <div class="solution">
            <h3>ุงูุญู 3: Fetch ุซู ุชุดุบูู</h3>
            <video id="fetchVideo" controls style="width:100%;"></video>
            <br>
            <button onclick="loadViaFetch()" style="padding:10px 20px; margin:10px; background:#3b82f6; color:white; border:none; border-radius:5px; cursor:pointer;">
                ๐ ุชุญููู ุงูุจุซ ุนุจุฑ Fetch
            </button>
        </div>
    </div>

    <script>
        // ุฑุงุจุท ุงูุจุซ ุงูุฃุตูู
        const originalStreamUrl = "http://offdz.lynxcontents.click:2086/push/334188914694/ZK8EAMHkmh/134410?expires=1769683453&token=3u51HYkrXM7_tARELpK-d9XpsGxB2hc8fZFEwKnx_TgmwlEOYtTgyEAsd-6GUKqzEB24aSayASqd9WCLY2f6jvt7xvbujWH-vmfRo3ypodPWDgsjo3n_c3DC3QDD8EX-s8l89Rn_rLxFZCOSxADMGOl9lYTbnmjQ0bRHDRdqiFNc9omlCdpW2ffOLWUR_tVD0nEzeNCsjGMq7lOUB54Q62PqVB3lRCRcXf1aDUlDafLeLkSqPtDy93rFcWkOJQ79";
        
        // ====== ุงูุญู 1: ุงุณุชุฎุฏุงู CORS Proxy ======
        // ูุฐู ุฎุฏูุฉ proxy ุนุงูุฉ (ูุฏ ุชูุชูู ุตูุงุญูุชูุง)
        const proxyUrl1 = `https://corsproxy.io/?${encodeURIComponent(originalStreamUrl)}`;
        const proxyUrl2 = `https://api.allorigins.win/raw?url=${encodeURIComponent(originalStreamUrl)}`;
        
        // ุฌุฑุจ ุงูุฃููุ ุฅุฐุง ูู ูุนูู ุฌุฑุจ ุงูุซุงูู
        const proxyVideo = document.getElementById('proxyVideo');
        proxyVideo.src = proxyUrl1;
        
        // ====== ุงูุญู 2: Iframe ูุน ุฅุนุฏุงุฏุงุช ุฎุงุตุฉ ======
        const frame = document.getElementById('streamFrame');
        frame.src = originalStreamUrl;
        
        // ====== ุงูุญู 3: Fetch ุซู ุชุดุบูู ======
        async function loadViaFetch() {
            const video = document.getElementById('fetchVideo');
            const btn = event.target;
            
            btn.disabled = true;
            btn.innerHTML = 'โณ ุฌุงุฑู ุงูุชุญููู...';
            
            try {
                // ูุญุงููุฉ ูุน proxy
                const proxyUrl = `https://api.allorigins.win/raw?url=${encodeURIComponent(originalStreamUrl)}`;
                
                const response = await fetch(proxyUrl);
                
                if (response.ok) {
                    // ุชุญููู ุงูุงุณุชุฌุงุจุฉ ุฅูู blob
                    const blob = await response.blob();
                    const url = URL.createObjectURL(blob);
                    
                    video.src = url;
                    video.load();
                    
                    btn.innerHTML = 'โ ุชู ุงูุชุญููู ุจูุฌุงุญ';
                    video.play().catch(e => console.log("ุงูุชุดุบูู ุงูุชููุงุฆู ููููุน:", e));
                } else {
                    throw new Error('ูุดู ูู ุฌูุจ ุงูุจูุงูุงุช');
                }
            } catch (error) {
                btn.innerHTML = 'โ ูุดู ุงูุชุญููู';
                alert('ูุดู ุงูุชุญููู: ' + error.message);
            } finally {
                setTimeout(() => {
                    btn.disabled = false;
                    btn.innerHTML = '๐ ุญุงูู ูุฑุฉ ุฃุฎุฑู';
                }, 3000);
            }
        }
        
        // ====== ุฎูุงุฑ ุฅุถุงูู: WebSocket ุจุฏูู ======
        function tryWebSocketApproach() {
            alert('ุฌุงุฑู ุชุฌุฑุจุฉ ุงุชุตุงู WebSocket...');
            
            // ุฅูุดุงุก ุงุชุตุงู WebSocket ุงูุชุฑุงุถู
            const wsProtocol = originalStreamUrl.startsWith('https') ? 'wss' : 'ws';
            const wsUrl = `${wsProtocol}://${originalStreamUrl.split('/')[2]}/ws`;
            
            console.log('ูุญุงููุฉ ุงูุงุชุตุงู ุจู:', wsUrl);
            
            // ูุฐุง ูุฌุฑุฏ ูุซุงู - ุณุชุญุชุงุฌ ุฅูู ูุนุฑูุฉ endpoint ุงูู WebSocket ุงููุนูู
        }
        
        console.log('ุฅุฐุง ูุงู ุงูุฑุงุจุท ูุนูู ูู ุชุจููุจ ุฌุฏูุฏุ ุฌุฑุจ ูุฐู ุงูุฎุทูุงุช:');
        console.log('1. ุงูุชุญ ุงููููุน ุนูู ุฎุงุฏู ุญูููู (ููุณ localhost)');
        console.log('2. ุงุณุชุฎุฏู HTTPS ุจุฏูุงู ูู HTTP');
        console.log('3. ุฃุถู header: crossorigin="anonymous" ููููุฏูู');
    </script>
</body>
</html>
